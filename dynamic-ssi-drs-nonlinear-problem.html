<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>14&nbsp; Nonlinear dynamic behavior of concrete gravity dams – Soil Dynamics and Earthquake Engineering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./dynamic-ssi-drs-nonlinear-vstfem.html" rel="next">
<link href="./dynamic-ssi-drs-vstfem.html" rel="prev">
<link href="././figures/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-93074729595c0d1bb0917954c6b21507.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://hypothes.is/embed.js"></script>
<script>
  window.document.addEventListener("DOMContentLoaded", function (_event) {
    document.body.classList.add('hypothesis-enabled');
  });
</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="14&nbsp; Nonlinear dynamic behavior of concrete gravity dams – Soil Dynamics and Earthquake Engineering">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://poromechanics.github.io/sdee/figures/ch7-fig-1.svg">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./dynamic-ssi-drs-nonlinear-problem.html"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Nonlinear dynamic behavior of concrete gravity dams</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Soil Dynamics and Earthquake Engineering</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/poromechanics/sdee/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Soil-Dynamics-and-Earthquake-Engineering.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Soil-Dynamics-and-Earthquake-Engineering.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tdg-first-order-ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">TDG/FEM for the first order ODE</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./tdg-second-order-ode.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">TDG/FEM for the second order ODE</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elastic-waves-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Elastic waves</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elastic-waves-body-waves-in-solids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Body waves in elastic solids</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elastic-waves-surface-waves-in-solids.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Surface waves in elastic solids</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elastic-waves-radiation-boundary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Radiation boundary conditions for elastic waves</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elastodynamics-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Elastodynamics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./elastodynamics-vstfem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">V-STFEM for Elastodynamics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic-ssi-vstfem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">v-STFEM for Dynamic-soil-structure interaction</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic-ssi-drs-introduction.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Dynamic SSI of Dam-Reservoir System</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic-ssi-drs-equations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Governing equation for Dam-Reservoir System</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic-ssi-drs-vstfem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">VSTFEM for dynamic SSI in dam-reservoir system</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic-ssi-drs-nonlinear-problem.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Nonlinear dynamic behavior of concrete gravity dams</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dynamic-ssi-drs-nonlinear-vstfem.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">V-STFEM for nonlinear dynamic analysis of concrete gravity dams</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><span class="header-section-number">14.1</span> Introduction</a></li>
  <li><a href="#statement-of-problem" id="toc-statement-of-problem" class="nav-link" data-scroll-target="#statement-of-problem"><span class="header-section-number">14.2</span> Statement of problem</a></li>
  <li><a href="#a-nonlinear-smeared-crack-model-for-concrete-material" id="toc-a-nonlinear-smeared-crack-model-for-concrete-material" class="nav-link" data-scroll-target="#a-nonlinear-smeared-crack-model-for-concrete-material"><span class="header-section-number">14.3</span> A nonlinear smeared crack model for concrete material</a>
  <ul class="collapse">
  <li><a href="#pre-softening-behavior" id="toc-pre-softening-behavior" class="nav-link" data-scroll-target="#pre-softening-behavior"><span class="header-section-number">14.3.1</span> Pre-softening behavior</a></li>
  <li><a href="#crack-initiation-criterion" id="toc-crack-initiation-criterion" class="nav-link" data-scroll-target="#crack-initiation-criterion"><span class="header-section-number">14.3.2</span> Crack initiation criterion</a></li>
  <li><a href="#strain-softening-model-for-concrete-and-fracture-energy-conservation" id="toc-strain-softening-model-for-concrete-and-fracture-energy-conservation" class="nav-link" data-scroll-target="#strain-softening-model-for-concrete-and-fracture-energy-conservation"><span class="header-section-number">14.3.3</span> Strain softening model for concrete and fracture energy conservation</a></li>
  <li><a href="#constitutive-relationship-during-softening" id="toc-constitutive-relationship-during-softening" class="nav-link" data-scroll-target="#constitutive-relationship-during-softening"><span class="header-section-number">14.3.4</span> Constitutive relationship during softening</a></li>
  <li><a href="#closing-and-reopening-of-cracks" id="toc-closing-and-reopening-of-cracks" class="nav-link" data-scroll-target="#closing-and-reopening-of-cracks"><span class="header-section-number">14.3.5</span> Closing and reopening of cracks</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/poromechanics/sdee/edit/main/dynamic-ssi-drs-nonlinear-problem.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/poromechanics/sdee/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Nonlinear dynamic behavior of concrete gravity dams</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2" data-number="14.1">
<h2 data-number="14.1" class="anchored" data-anchor-id="introduction"><span class="header-section-number">14.1</span> Introduction</h2>
<p>In previous chapters linear dynamic problems are solved by using v-ST/FEM. In Chapter <a href="#ch:ch6" data-reference-type="ref" data-reference="ch:ch6">[ch:ch6]</a>, linear dynamic analysis of gravity dam subjected to the earthquake ground motion show that the large tensile stresses may develop in dam which can exceed the tensile strength of the mass concrete. In such cases, a linear analysis is no longer valid since tensile cracks will form and propagates in the concrete, affecting the vibration properties an dynamic response of the dam. Consequently, cracking based on seismic actions in dams is an important factor in the safety evaluation of gravity dams and it may cause catastrophic consequences such as loss of life and property if the dam fails.</p>
<p>Extensive research has been performed over the last 25 years into the fracture behavior of concrete. A tensile-strength-based crack propagation analysis is generally considered unreliable due to the mesh-dependent response prediction <span class="citation" data-cites="Bazant1987">(<a href="references.html#ref-Bazant1987" role="doc-biblioref">Bažant 1987</a>)</span>. Non-linear behavior in the fracture process zone (FPZ), which is significantly large for the concrete normally used in dams, is neglected in the conventional linear elastic fracture mechanics (LEFM) models. Under very slowly applied loads and also under impulsive loads, concrete fracture behavior seems to be adequately predicted by the LEFM models <span class="citation" data-cites="Bhattacharjee1993">(<a href="references.html#ref-Bhattacharjee1993" role="doc-biblioref">Bhattacharjee and Leger 1993</a>)</span>. In the intermediate range, from short-term static loading to seismic-induced strain rates, non-linear fracture mechanics (NLFM) models considering the strain softening behavior in the FPZ appear to be more appropriate.</p>
<p>Continuum mechanics approaches to represent the tensile crack propagation are computationally very attractive for applications in complex structural analysis when the crack profiles are not known a priori. General drawbacks of the conventional smeared crack analysis model, such as the mesh-sensitive response prediction and the stress-locking in finite elements, can largely be overcome using the energy conserving co-axial rotating crack model (CRCM), which is an improved NLFM model <span class="citation" data-cites="Bhattacharjee1993">(<a href="references.html#ref-Bhattacharjee1993" role="doc-biblioref">Bhattacharjee and Leger 1993</a>)</span>.</p>
<p><span class="citation" data-cites="Bhattacharjee1993">(<a href="references.html#ref-Bhattacharjee1993" role="doc-biblioref">Bhattacharjee and Leger 1993</a>)</span> investigated the dynamic fracture response of Koyna dam by using the CRCM concrete model. In the analysis of this dam, the foundation was assumed to be rigid, and the dynamic interaction of dam-reservoir system was modeled by the Westergaard added mass technique. The response results of the dam indicated that cracks formed at the base and at the upper portion near the change in downstream slope for the Koyna earthquake records. <span class="citation" data-cites="Lee1998">(<a href="references.html#ref-Lee1998" role="doc-biblioref">Lee and Fenves 1998</a>)</span> also obtained similar solutions for Koyna dam under the same boundary and loading conditions by using a plastic-damage concrete model which includes tension and compression strain softening effects. They studied in detail tension damage in the dam and noted that damage in compression is less important in comparison with damage in tension for dams. In another paper, <span class="citation" data-cites="Cervera1995">(<a href="references.html#ref-Cervera1995" role="doc-biblioref">Cervera, Oliver, and Faria 1995</a>)</span> developed an isotropic damage model for the seismic evaluation of concrete gravity and arch dams. This model accounts for the different behavior of concrete in tension and compression by splitting the stress tensor into tensile and compressive components, each with its own damage surface and evolution law. The seismic analyses of their selected gravity dam which resembles very closely Koyna dam, including dam-reservoir-foundation interactions, subjected to artificially generated earthquakes of different intensities indicated tension damage in the dam, but no compression damage occurred. The formed tension damage was seen at the upper portion of the dam. In the lights of these investigations, the tension cracks have only important influence on the seismic response of concrete gravity dams. Therefore, tension cracking is only considered in the present study.</p>
<p>In this chapter, v-ST/FEM is employed for the problems involving dynamic response of solids and structures with nonlinear stress-strain relationships. The structure of the present chapter is described as follows. First, we will define the problem of dynamic interaction between the concrete gravity dam and reservoir, in which a generalized nonlinear stress-strain relationship is used to describe the material behavior of concrete in the dam. Then we will discuss the space-time weak form of the model problem. , It is shown that the nonlinearity is caused by only the presence of stress term in the v-ST/FEM weak form. Subsequently, two v-ST/FEM schemes are proposed for the time integration of the space-time nodal vectors and matrices comprising the stress term. This chapter also presents a block-iterative scheme to enforce the coupling between the solid and fluid domain. Finally, the numerical results of the nonlinear dynamic analysis of a concrete gravity dam subjected to the earthquake ground motion are presented and discussed.</p>
</section>
<section id="statement-of-problem" class="level2" data-number="14.2">
<h2 data-number="14.2" class="anchored" data-anchor-id="statement-of-problem"><span class="header-section-number">14.2</span> Statement of problem</h2>
<p><a href="dynamic-ssi-drs-equations.html#fig-ch6-fig2" class="quarto-xref">Figure&nbsp;<span>12.2</span></a> depicts the dam-reservoir system situated on a relatively rigid ground which is subjected to the spatially uniform transient ground motion. The horizontal and vertical component of ground motion are denoted by <span class="math inline">\(a_{1}^{g}(t)\)</span> and <span class="math inline">\(a_{2}^{g}(t)\)</span>, respectively. Henceforth, the superscript <span class="math inline">\({(\cdot)}^{s}\)</span> and <span class="math inline">\({(\cdot)}^{f}\)</span> will be used for denoting the quantities related to the solid (dam) and fluid domain, respectively. Let <span class="math inline">\(\Omega^{f}\)</span> be the computation domain of reservoir which is enclosed by a free surface <span class="math inline">\(\Gamma_{f}^{f}\)</span>, an upstream artificial boundary <span class="math inline">\(\Gamma_{\infty}^{f}\)</span>, a fluid-soil interface <span class="math inline">\(\Gamma^{f}_{fs}\)</span>, and a fluid-dam interface <span class="math inline">\(\Gamma_{fd}^{f}\)</span>. Accordingly, the boundary of the fluid domain can be described by</p>
<p><span id="eq-ch7-1"><span class="math display">\[
\Gamma_{}^f = \Gamma_f^f \cup \Gamma_\infty^f \cup \Gamma _{fs}^f \cup \Gamma_{fd}^f
\tag{14.1}\]</span></span></p>
<p>Let <span class="math inline">\(\Omega^{s}\)</span> be the computation domain of dam, <span class="math inline">\(\Gamma_{fd}^{s}\)</span> be the fluid-dam interface of dam, and <span class="math inline">\(\Gamma_{ds}^{s}\)</span> be the base of the dam. The outward unit normal vectors to the fluid and solid boundary are denoted by <span class="math inline">\(\mathbf{n}^{s}\)</span> and <span class="math inline">\(\mathbf{n}^{f}\)</span>, respectively, and</p>
<p><span id="eq-ch7-2"><span class="math display">\[
{{\mathbf{n}}^s} + {{\mathbf{n}}^f} = {\mathbf{0}}
\tag{14.2}\]</span></span></p>
<p>Since the ground underneath the dam, which is in spatially uniform motion, is assumed to be perfectly-rigid it is advantageous to describe the motion of the dam relative to the ground. Let <span class="math inline">\(\mathbf{u}\)</span> and <span class="math inline">\(\mathbf{v}\)</span> be the relative displacements and relative velocities of the dam, respectively, and <span class="math inline">\(\rho^{s}\)</span> be the mass-density of the dam. The governing equation of motion for the dam becomes,</p>
<p><span id="eq-ch7-3"><span class="math display">\[
{\rho ^s}\frac{{\partial {v_i}}}{{\partial t}} - \frac{{\partial {\sigma _{ij}}}}{{\partial {x_j}}} = {\rho ^s}\left( {{b_i} - a_i^g} \right) \quad \forall ({\mathbf{x}},t) \in {\Omega ^s} \times (0,T)
\tag{14.3}\]</span></span></p>
<p>where <span class="math inline">\(b_{i}\)</span> is the external body force density, and <span class="math inline">\(-\rho^{s}\mathbf{a}^{g}(t)\)</span> is the pseudo force acting on the dam due to the accelerating frame of reference. The above equation can be derived from the <a href="dynamic-ssi-drs-equations.html#eq-ch6-10" class="quarto-xref">Equation&nbsp;<span>12.10</span></a> while noting that the spatial gradient of ground motion is zero. The initial conditions for the dam are given by,</p>
<p><span id="eq-ch7-4"><span class="math display">\[
\begin{split}
{u_i}\left( {{\mathbf{x}},0} \right) = u_i^0\left( {\mathbf{x}} \right)\quad \,\forall {\mathbf{x}} \in {\Omega ^s}
\\
{v_i}\left( {{\mathbf{x}},0} \right) = v_i^0\left( {\mathbf{x}} \right)\quad \,\forall {\mathbf{x}} \in {\Omega ^s}
\end{split}
\tag{14.4}\]</span></span></p>
<p>and the boundary condition,</p>
<p><span id="eq-ch7-5"><span class="math display">\[
{u_i}\left( {{\mathbf{x}},t} \right) = 0\quad \,\forall \left( {{\mathbf{x}},t} \right) \in \Gamma _{s}^{ds} \times \left( {0,T} \right)
\tag{14.5}\]</span></span></p>
<p>characterizes the rigid-base boundary condition for the dam at <span class="math inline">\(\Gamma^{s}_{ds}\)</span>.</p>
<p>The traction boundary condition for the dam can be divided into two components; (i) traction boundary condition due to the external surface loads acting on <span class="math inline">\(\Gamma^{s}_{h}\)</span> (see <a href="#eq-ch7-6" class="quarto-xref">Equation&nbsp;<span>14.6</span></a>, (ii) traction boundary condition due to total pressure (hydrostatic and hydrodynamic pressure) of impounded water acting on <span class="math inline">\(\Gamma^{s}_{fd}\)</span> (see <a href="#eq-ch7-7" class="quarto-xref">Equation&nbsp;<span>14.7</span></a>).</p>
<p><span id="eq-ch7-6"><span class="math display">\[
\sigma  \cdot {\mathbf{n}}_{}^s = {\mathbf{h}}\quad \forall \left( {{\mathbf{x}},t} \right) \in \Gamma _h^s \times \left( {0,T} \right)
\tag{14.6}\]</span></span></p>
<p><span id="eq-ch7-7"><span class="math display">\[
\sigma  \cdot {\mathbf{n}}^{s} =  - p_{0}\left( {{\mathbf{x}}} \right){\mathbf{n}}_{}^s p\left( {{\mathbf{x}},t} \right){\mathbf{n}}_{}^s \quad
\forall \left( {{\mathbf{x}},t} \right) \in \Gamma _{fd}^s \times \left( {0,T} \right)
\tag{14.7}\]</span></span></p>
<p>If it is assumed that the strains in the dam body are small enough so that the problem remains geometrically linear then the nonlinear stress-strain relationship for the dam can be described by rate-form,</p>
<p><span id="eq-ch7-8"><span class="math display">\[
\begin{aligned}
\frac{{\partial \sigma }}{{\partial t}} &amp;= {\mathbf{C}}:{\mathbf{d}}&amp;
\text{or}&amp;
&amp;\frac{{\partial \sigma_{ij} }}{{\partial t}} &amp;= {\mathbf{C}_{ijkl}}:{\mathbf{d}_{kl}}&amp;
\end{aligned}
\tag{14.8}\]</span></span></p>
<p>where <span class="math inline">\(\mathbf{C}\)</span> denotes a fourth order tangent modulus tensor which may depends upon the small-strain tensor <span class="math inline">\(\mathbf{\epsilon}\)</span>, stretching tensor <span class="math inline">\(\mathbf{d}\)</span>, and/or some internal variables <span class="citation" data-cites="Hashiguchi2014">(<a href="references.html#ref-Hashiguchi2014" role="doc-biblioref">Hashiguchi 2014</a>)</span>. Expression for small-strain tensor and stretching tensor is given below,</p>
<p><span id="eq-ch7-9"><span class="math display">\[
{\epsilon _{ij}} = \frac{1}{2}\left( {\frac{{\partial {u_i}}}{{\partial {x_j}}} + \frac{{\partial {u_j}}}{{\partial {x_i}}}} \right)
\tag{14.9}\]</span></span></p>
<p><span id="eq-ch7-10"><span class="math display">\[
{d_{ij}} = \frac{1}{2}\left( {\frac{{\partial {v_i}}}{{\partial {x_j}}} + \frac{{\partial {v_j}}}{{\partial {x_i}}}} \right)
\tag{14.10}\]</span></span></p>
<p>Let us now focus on the governing equations for the impounded water in the reservoir. Assuming the impounded water in the reservoir to be inviscid, linearly compressible with a small amplitudes for the displacements and velocity, the initial-boundary value problem for the fluid domain can be described as follows <span class="citation" data-cites="Zienkiewicz2005">(<a href="references.html#ref-Zienkiewicz2005" role="doc-biblioref">Zienkiewicz and Taylor 2005</a>)</span>.</p>
<p><span id="eq-ch7-11"><span class="math display">\[
\frac{1}{{{c^2}}}\frac{{{\partial^2}p}}{{\partial {t^2}}} - \frac{{{\partial^2}p}}{{\partial x_i^2}} = 0\quad {\text{in}}\quad {\forall (\mathbf{x},t) \in \Omega^f \times (0,T)}
\tag{14.11}\]</span></span></p>
<p><span id="eq-ch7-12"><span class="math display">\[
p\left( {{\mathbf{x}},0} \right) = 0 \quad \forall \mathbf{x} \in \Omega^{f}
\tag{14.12}\]</span></span></p>
<p><span id="eq-ch7-13"><span class="math display">\[
\frac{\partial p\left( {{\mathbf{x}},0} \right)}{\partial t} = 0 \quad \forall \mathbf{x} \in \Omega^{f}
\tag{14.13}\]</span></span></p>
<p><span id="eq-ch7-14"><span class="math display">\[
p(x,t) = 0 \quad \forall (\mathbf{x},t) \in \Gamma^{f}_{f} \times (0,T)
\tag{14.14}\]</span></span></p>
<p><span id="eq-ch7-15"><span class="math display">\[
\nabla p \cdot {{\mathbf{n}}^f} =  - \frac{1}{c}\frac{{\partial p}}{{\partial t}}  + \frac{1}{c}\frac{{\partial {p^f}}}{{\partial t}} \quad \forall (\mathbf{x},t) \in \Gamma^{f}_{\infty} \times (0,T)
\tag{14.15}\]</span></span></p>
<p><span id="eq-ch7-16"><span class="math display">\[
\nabla p \cdot {{\mathbf{n}}^f} =  - {\rho ^f}\frac{{\partial {\mathbf{v}}}}{{\partial t}} \cdot {{\mathbf{n}}^f} - {\rho ^f}{{\mathbf{a}}^g} \cdot {{\mathbf{n}}^f}\quad \forall ({\mathbf{x}},t) \in \Gamma _{fd}^f \times (0,T)
\tag{14.16}\]</span></span></p>
<p><span id="eq-ch7-17"><span class="math display">\[
\nabla p \cdot {{\mathbf{n}}^f} =  - {\rho ^f}{{\mathbf{a}}^g} \cdot {{\mathbf{n}}^f} - {q_c}\frac{{\partial p}}{{\partial t}} \quad \forall (\mathbf{x},t) \in \Gamma^{f}_{fs} \times (0,T)
\tag{14.17}\]</span></span></p>
<p>where <span class="math inline">\(p(\vec{x},t)\)</span> is the hydrodynamic pressure in the water (in excess of hydrostatic pressure), <span class="math inline">\(c\)</span> is the speed of sound in water, <span class="math inline">\(p^{f}\)</span> is the free-field hydrodynamic pressure in the reservoir, <span class="math inline">\(\mathbf{a}^{g}(t)\)</span> is the spatially uniform ground motion, <span class="math inline">\(\rho^{f}\)</span> is the mass density of the water. <a href="#eq-ch7-16" class="quarto-xref">Equation&nbsp;<span>14.16</span></a>, <span class="math inline">\(\mathbf{v}\)</span> denotes the relative velocity of the dam with respect to the base of the dam. In <a href="#eq-ch7-17" class="quarto-xref">Equation&nbsp;<span>14.17</span></a>, <span class="math inline">\(q_{c}\)</span> is the damping coefficient which is the fundamental parameter characterizing the effect of reservoir bottom materials and it is given in <span class="citation" data-cites="Fenves1983">(<a href="references.html#ref-Fenves1983" role="doc-biblioref">Fenves and Chopra 1983</a>)</span> as,</p>
<p><span id="eq-ch7-18"><span class="math display">\[
{q_c} = \frac{{1 - {\alpha_{b}}}}{{c\left( {1 + {\alpha_{b}}} \right)}}
\tag{14.18}\]</span></span></p>
<p>in which, <span class="math inline">\(\alpha_{b}\)</span> is the ratio of the amplitude of reflected hydrodynamic pressure wave to the amplitude of a vertically propagating pressure wave incident on the reservoir bottom.</p>
<p>Note that the governing equation for the fluid domain, which is given by <a href="#eq-ch7-11" class="quarto-xref">Equation&nbsp;<span>14.11</span></a>, remains linear for both <span class="math inline">\(p\)</span> and <span class="math inline">\(\mathbf{v}\)</span>. This equation is identical to the one presented in the last chapter. The governing equation for the solid domain (i.e.&nbsp;dam), which is given by <a href="#eq-ch7-3" class="quarto-xref">Equation&nbsp;<span>14.3</span></a>, is nonlinear due to the nonlinear stress-strain relationship. However, this equation is linear in hydrodynamic pressure acting on the dam-fluid interface (see boundary condition given by <a href="#eq-ch7-7" class="quarto-xref">Equation&nbsp;<span>14.7</span></a>. The linearity of <a href="#eq-ch7-3" class="quarto-xref">Equation&nbsp;<span>14.3</span></a> in <span class="math inline">\(p\)</span> and <a href="#eq-ch7-11" class="quarto-xref">Equation&nbsp;<span>14.11</span></a> in <span class="math inline">\(\mathbf{v}\)</span> implies the linear coupling between fluid and solid domain.</p>
</section>
<section id="a-nonlinear-smeared-crack-model-for-concrete-material" class="level2 page-columns page-full" data-number="14.3">
<h2 data-number="14.3" class="anchored" data-anchor-id="a-nonlinear-smeared-crack-model-for-concrete-material"><span class="header-section-number">14.3</span> A nonlinear smeared crack model for concrete material</h2>
<p>Materials such as concrete, mortar, and rocks have very less tensile strength (about 10 percent) than compressive strength and exhibit a quasi-brittle behavior. Tensile fracture in concrete like materials involves progressive micro-cracking, tortuous debonding and other processes of internal damage which eventually coalesce into a macro-cracks. Accordingly, a mass concrete when subjected to the tensile loading undergo strain softening before leading to a complete loss of strength. <a href="#fig-ch7-1" class="quarto-xref">Figure&nbsp;<span>14.1</span></a> shows a typical stress-strain relationship for mass concrete from uniaxial tension test obtained by <span class="citation" data-cites="Bruhwiler1990">(<a href="references.html#ref-Bruhwiler1990" role="doc-biblioref">Brühwiler 1990</a>)</span>. At the beginning, a linear relationship between stress and strain exists until the elastic limit is reached. Once the elastic limit is crossed, micro-cracks develop within the mass concrete, which results in nonlinearity in the curve up to the ultimate tensile strength <span class="math inline">\(\sigma_{t}\)</span>. The post-peak behavior starts with the strain-softening due to growth of micro-cracks in the weakest cross-section of the specimen which then coalescence into a crack: a geometrical discontinuity that separates the material. Therefore, the stress-strain relationship for the concrete like materials can be divided into two regime: (i) pre-softening regime and (ii) softening regime.</p>

<div class="no-row-height column-margin column-container"><div class="">
<div id="fig-ch7-1" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch7-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./figures/ch7-fig-1.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch7-1-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.1: Typical stress-strain curve for mass concrete from simple tension test after <span class="citation" data-cites="Bruhwiler1990">(<a href="references.html#ref-Bruhwiler1990" role="doc-biblioref">Brühwiler 1990</a>)</span>
</figcaption>
</figure>
</div>
</div></div><p>In what follows the co-axially rotating crack model (CRCM)<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> which is defined by (i) the pre-softening material behavior, (ii) the criterion for crack initiation, (iii) the fracture energy conservation, and (iv) the growth, closing and reopening of cracks, and v-ST/FEM implementation of this constitutive model are presented.</p>
<section id="pre-softening-behavior" class="level3" data-number="14.3.1">
<h3 data-number="14.3.1" class="anchored" data-anchor-id="pre-softening-behavior"><span class="header-section-number">14.3.1</span> Pre-softening behavior</h3>
<p>The stress-strain relationship at a material point is given by</p>
<p><span id="eq-ch7-71"><span class="math display">\[
\left\{ \sigma  \right\} = \left[ {\mathbf{C}} \right] \cdot \left\{ \varepsilon  \right\}
\tag{14.19}\]</span></span></p>
<p>where <span class="math inline">\(\left[ {\mathbf{C}} \right]\)</span>, <span class="math inline">\(\left\{ \sigma  \right\} = \left[ {{\sigma_{11}},{\sigma_{22}},{\sigma_{12}}} \right]\)</span> and <span class="math inline">\(\left\{ \varepsilon  \right\} = \left[ {{\varepsilon_{11}},{\varepsilon_{22}},2{\varepsilon_{12}}} \right]\)</span> denotes Voigt-form of the constitutive matrix, stress tensor and strain tensor, respectively. In pre-softening case since there are no cracks developed in concrete, the standard elastic plane stress-strain matrix for an isotropic material is used. Then, the matrix</p>
<p><span class="math inline">\(\left[ {\mathbf{C}} \right]\)</span> is given by</p>
<p><span id="eq-ch-72"><span class="math display">\[
\left[ {\mathbf{C}} \right] = \frac{E_{0}}{{1 - {\nu ^2}}}\left[ {\begin{array}{cc}
  1&amp;\nu &amp;0 \\
  \nu &amp;1&amp;0 \\
  0&amp;0&amp;{\frac{{1 - \nu }}{2}}
\end{array}} \right]
\tag{14.20}\]</span></span></p>
<p>where <span class="math inline">\(\nu\)</span> is the Poisson’s ratio, and <span class="math inline">\(E_{0}\)</span> is the modulus of elasticity.</p>
<div id="fig-ch7-2" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-ch7-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="./figures/ch7-fig-2.svg" class="img-fluid figure-img">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-ch7-2-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;14.2: Constitutive modeling for nonlinear smeared crack analysis. (a) Idealized stress-strain curve for concrete; (b) biaxial stress effect in the strain softening initiation; (c) local axis system; (d) closing and reopening of cracks.
</figcaption>
</figure>
</div>
</section>
<section id="crack-initiation-criterion" class="level3" data-number="14.3.2">
<h3 data-number="14.3.2" class="anchored" data-anchor-id="crack-initiation-criterion"><span class="header-section-number">14.3.2</span> Crack initiation criterion</h3>
<p>The stress-strain relationship for concrete becomes non-linear near the peak strength as shown in <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> . In the post-peak strain softening phase, coalescence of the micro-cracks causes a gradual reduction of the stress resistance. The area under the uniaxial stress-strain curve up to the peak, defined in <a href="#eq-ch7-71" class="quarto-xref">Equation&nbsp;<span>14.19</span></a>, is taken as the index for softening initiation:</p>
<p><span id="eq-ch7-73"><span class="math display">\[
{U_0} = \frac{1}{2}{\sigma _t}{\varepsilon _0}=\frac{\sigma_{t}^{2}}{2E_{0}}
\tag{14.21}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_{t}\)</span> is the uniaxial tensile strength of mass concrete, <span class="math inline">\(\varepsilon_{0}\)</span> is the corresponding strain threshold, <span class="math inline">\(E_{0}\)</span> is the modulus of elasticity. In the plane-stress finite element analyses, the crack initiation criterion is given by <span class="citation" data-cites="Bhattacharjee1993 Calayir2005">(<a href="references.html#ref-Bhattacharjee1993" role="doc-biblioref">Bhattacharjee and Leger 1993</a>; <a href="references.html#ref-Calayir2005" role="doc-biblioref">Calayir and Karaton 2005</a>)</span></p>
<p><span id="eq-ch7-74"><span class="math display">\[
\frac{1}{2}{\sigma_{1}\varepsilon_{1}} \ge U_{0}
\tag{14.22}\]</span></span></p>
<p>where <span class="math inline">\(\sigma_{1}\)</span> and <span class="math inline">\(\varepsilon_{1}\)</span> are the maximum principal stress and strain, respectively. In above equation the term <span class="math inline">\((\sigma_{1}\varepsilon_{1}/2)\)</span> denotes the tensile strain energy density. Accordingly, the biaxial effect in the crack initiation criterion may be given by</p>
<p><span id="eq-ch7-75"><span class="math display">\[
\sigma_{1} \ge \frac{\sigma_{t}^{2}}{E_{0} \varepsilon_{1}}\quad
\text{or} \quad
\frac{\sigma_{1}}{\sigma_{t}} \ge \sqrt{\frac{\sigma_{1}}{E_{0}\varepsilon_{1}}}
\tag{14.23}\]</span></span></p>
<p>This equation represents a biaxial failure envelope which is illustrated in <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> It can be observed that strain softening occurs for tension-tension and tension-compression stress states due to tension cracking, however, no cracks develop under compression-compression stress state.</p>
</section>
<section id="strain-softening-model-for-concrete-and-fracture-energy-conservation" class="level3" data-number="14.3.3">
<h3 data-number="14.3.3" class="anchored" data-anchor-id="strain-softening-model-for-concrete-and-fracture-energy-conservation"><span class="header-section-number">14.3.3</span> Strain softening model for concrete and fracture energy conservation</h3>
<p><span class="citation" data-cites="Bhattacharjee1993">(<a href="references.html#ref-Bhattacharjee1993" role="doc-biblioref">Bhattacharjee and Leger 1993</a>)</span> used a linear strain softening relationship; the tensile resistance of concrete is assumed to decrease linearly from the pre-softening undamaged state to the fully damaged state of zero tensile resistance. Recently, numerous researchers have shown that it is more realistic to assume a strain softening curve with a steep initial decline followed by an extended tail <span class="citation" data-cites="Kurumatani2016 Geers2000 Jirasek2008 Giry2011 Peerlings1998 Calayir2005">(<a href="references.html#ref-Kurumatani2016" role="doc-biblioref">Kurumatani et al. 2016</a>; <a href="references.html#ref-Geers2000" role="doc-biblioref">Geers, De Borst, and Peerlings 2000</a>; <a href="references.html#ref-Jirasek2008" role="doc-biblioref">Jirasek and Grassl 2008</a>; <a href="references.html#ref-Giry2011" role="doc-biblioref">Giry, Dufour, and Mazars 2011</a>; <a href="references.html#ref-Peerlings1998" role="doc-biblioref">Peerlings et al. 1998</a>; <a href="references.html#ref-Calayir2005" role="doc-biblioref">Calayir and Karaton 2005</a>)</span>. According to <span class="citation" data-cites="Calayir2005">(<a href="references.html#ref-Calayir2005" role="doc-biblioref">Calayir and Karaton 2005</a>)</span>, the post-peak strain softening behavior of concrete can be modeled by using following exponential strain softening relationship (see also <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> a)</p>
<p><span id="eq-ch7-76"><span class="math display">\[
\sigma \left( \varepsilon  \right) = \left\{ \begin{gathered}
  {E_0}\varepsilon ,\quad \varepsilon  \leqslant {\varepsilon _0} \\
  {\sigma _t}\left[ {2{e^{ - a\left( {\varepsilon  - {\varepsilon _0}} \right)}} - {e^{ - 2a\left( {\varepsilon  - {\varepsilon _0}} \right)}}} \right],\quad {\varepsilon _0} &lt; \varepsilon  &lt; {\varepsilon _{cr}} \\
  0,\qquad \varepsilon  \geqslant {\varepsilon _{cr}} \\
\end{gathered}  \right.
\tag{14.24}\]</span></span></p>
<p>where <span class="math inline">\(\varepsilon_{cr}\)</span> denotes the maximum strain that may not be exceeded during strain softening, and is consistent with the study carried out by <span class="citation" data-cites="Bazant1987">(<a href="references.html#ref-Bazant1987" role="doc-biblioref">Bažant 1987</a>)</span>. The value of <span class="math inline">\(\varepsilon_{cr}\)</span> can be calculated when its corresponding stress given is equal to <span class="math inline">\(\delta_{cr} \sigma_{t}\)</span>. Thus, <span class="math inline">\(\sigma = \delta_{cr} \sigma_{t}\)</span> in <a href="#eq-ch7-76" class="quarto-xref">Equation&nbsp;<span>14.24</span></a> b one can expressed <span class="math inline">\(\varepsilon\)</span> as</p>
<p><span id="eq-ch7-77"><span class="math display">\[
{\varepsilon _{cr}} = {\varepsilon _0} + \frac{1}{a}\ln \left( {\frac{{1 + \sqrt {1 - {\delta _{cr}}} }}{{{\delta _{cr}}}}} \right)
\tag{14.25}\]</span></span></p>
<p>In this study <span class="math inline">\(\delta_{cr}=0.02\)</span>, therefore, <span class="math inline">\({\varepsilon _{cr}}\)</span> is given by</p>
<p><span id="eq-ch7-78"><span class="math display">\[
{\varepsilon _{cr}}={\varepsilon _{0}} + \frac{4.6}{a}
\tag{14.26}\]</span></span></p>
<p>In <a href="#eq-ch7-76" class="quarto-xref">Equation&nbsp;<span>14.24</span></a>, <a href="#eq-ch7-77" class="quarto-xref">Equation&nbsp;<span>14.25</span></a>, <a href="#eq-ch7-78" class="quarto-xref">Equation&nbsp;<span>14.26</span></a> <span class="math inline">\(a\)</span> is a dimensionless parameter which is related to the slope of the softening curve. The parameter <span class="math inline">\(a\)</span> should be adjusted such that the energy dissipation for a unit area of crack plane propagation is conserved. Let the fracture energy<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> be denoted by <span class="math inline">\(G_{f}\)</span>. In the energy balance approach it is assumed that the fracture energy <span class="math inline">\(G_{f}\)</span> will be absorbed due to formation of a unit area of crack surface. When the crack propagates a certain amount of stored energy is released, and the crack can only propagates when the released energy is equal to or greater than the absorbed energy <span class="citation" data-cites="Hillerborg1976">(<a href="references.html#ref-Hillerborg1976" role="doc-biblioref">Hillerborg, Modéer, and Petersson 1976</a>)</span>. The limiting value of <span class="math inline">\(a\)</span> can be obtained b,</p>
<p><span id="eq-ch7-79"><span class="math display">\[
\int_0^\infty  {\sigma d\varepsilon } : = \int_0^{{\varepsilon _0}} {\sigma d\varepsilon }  + \int_{{\varepsilon _0}}^\infty  {\sigma d\varepsilon }  = \frac{{{G_f}}}{{{l_{ch}}}}
\tag{14.27}\]</span></span></p>
<p>Now, use of the stress-strain relationship as given by <a href="#eq-ch7-76" class="quarto-xref">Equation&nbsp;<span>14.24</span></a> in above equation will yield following expression for <span class="math inline">\(a\)</span>.</p>
<p><span id="eq-ch7-80"><span class="math display">\[
a = \frac{3}{{{\varepsilon _o}\left( {\frac{{2{G_f}}}{{{l_{ch}}{\sigma _t}{\varepsilon _o}}} - 1} \right)}} \geqslant 0
\tag{14.28}\]</span></span></p>
<p>In <a href="#eq-ch7-79" class="quarto-xref">Equation&nbsp;<span>14.27</span></a> and <a href="#eq-ch7-80" class="quarto-xref">Equation&nbsp;<span>14.28</span></a>, <span class="math inline">\(l_{ch}\)</span> is a geometrical constant which is introduced as a measure of the length of fracture processing zone in mass concrete. In two-dimensional finite element analyses, <span class="math inline">\(l_{ch}\)</span> can be calculated by using the relations given below <span class="citation" data-cites="Kurumatani2016">(<a href="references.html#ref-Kurumatani2016" role="doc-biblioref">Kurumatani et al. 2016</a>)</span>,</p>
<p><span id="eq-ch7-81"><span class="math display">\[
\begin{split}
\text{Triangular element:}&amp; l_{ch} = \sqrt{2A_{e}}
\\
\text{Quadrilateral element:}&amp; l_{ch} = \sqrt{A_{e}}
\end{split}
\tag{14.29}\]</span></span></p>
<p>in which <span class="math inline">\(A_{e}\)</span> denotes the area of a two-dimensional finite element.</p>
</section>
<section id="constitutive-relationship-during-softening" class="level3" data-number="14.3.4">
<h3 data-number="14.3.4" class="anchored" data-anchor-id="constitutive-relationship-during-softening"><span class="header-section-number">14.3.4</span> Constitutive relationship during softening</h3>
<p>After the softening initiation, a smeared band of micro-cracks is assumed to appear in the direction normal to the principal the tensile stress. The axes of principal stresses rotates during the cracking. In a co-axially rotating crack model (CRCM), the axes of principal stress and strain are allowed to rotate during or after cracking while assuming stress and strain to be coaxial (Rots, 1991; Bhattacharjee and Leger, 1993; Calayir and Karaton, 2005). The material reference axis system, referred to as the local axis system, is aligned with the principal strain directions (direction <span class="math inline">\(n-s\)</span> in <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> c). The constitutive matrix relating the local stresses to local strains is defined as</p>
<p><span id="eq-ch7-82"><span class="math display">\[
\left[ {{{\mathbf{C}}_{ns}}} \right] = \frac{{{E_0}}}{{1 - \eta {\nu ^2}}}\left[ {\begin{array}{cc}
  \eta &amp;{\nu \eta }&amp;0 \\
  {\eta \nu }&amp;1&amp;0 \\
  0&amp;0&amp;{\mu \frac{{1 - \eta {\nu ^2}}}{{2\left( {1 + \nu } \right)}}}
\end{array}} \right]
; \quad \eta = \frac{E_{n}}{E_{0}}
\tag{14.30}\]</span></span></p>
<p>where <span class="math inline">\(\eta \in [0,1]\)</span> is the ratio of the softened elastic modulus (<span class="math inline">\(E_{n}\)</span>) in the direction normal to the fracture plane to the initial isotropic elastic modulus (<span class="math inline">\(E_{0}\)</span>), thus <span class="math inline">\(\eta\)</span> denotes the damaged state of the material; <span class="math inline">\(\eta=1\)</span> implies undamaged state and <span class="math inline">\(\eta=0\)</span> implies a fully damaged state. In this equation, <span class="math inline">\(\mu\)</span> is the shear resistance factor defined for the CRCM as follows:</p>
<p><span class="math display">\[
\mu  = \frac{{1 + \nu }}{{1 - \eta {\nu ^2}}}\left( {\frac{{\eta {\varepsilon _n} - {\varepsilon _s}}}{{{\varepsilon _n} - {\varepsilon _s}}} - \eta \nu } \right),\qquad \mu  \in \left[ {0,1} \right]
\]</span></p>
<p>where <span class="math inline">\(\varepsilon_{n}\)</span> is the maximum principal strain,</p>
<p><span class="math inline">\({\varepsilon_{s} } = \max \left( {{\varepsilon_{1}},{\varepsilon_{2}}} \right)\)</span>, which is in normal direction to the fracture plane, and <span class="math inline">\(\varepsilon_{s}\)</span> is the minimum principal strain, <span class="math inline">\({\varepsilon_{s}} = \min \left( {{\varepsilon_{1}},{\varepsilon_{2}}} \right)\)</span>, which in the direction parallel to the fracture plane (i.e., smeared band of micro-cracks).</p>
<p>It is important to note that in <a href="#eq-ch7-82" class="quarto-xref">Equation&nbsp;<span>14.30</span></a> constitutive matrix <span class="math inline">\(\left[ \mathbf{C}_{ns} \right]\)</span> is defined in the local axis system (<span class="math inline">\(n-s\)</span> direction in <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> c.&nbsp;However, in a finite element computation this matrix is transformed to the global <span class="math inline">\(x-y\)</span> coordinate directions, <span class="math inline">\(\left[ {{{\mathbf{C}}_{global}}} \right]\)</span>, by using</p>
<p><span id="eq-ch7-84"><span class="math display">\[
\left[ {{{\mathbf{C}}_{global}}} \right] = {\left[ {\mathbf{R}} \right]^T}\left[ {{{\mathbf{C}}_{ns}}} \right]\left[ {\mathbf{R}} \right]
\tag{14.31}\]</span></span></p>
<p>where</p>
<p><span id="eq-ch7-85"><span class="math display">\[
\left[ {\mathbf{R}} \right] = \left[ {\begin{array}{cc}
  {{{\cos }^2}\theta }&amp;{{{\sin }^2}\theta }&amp;{\sin \theta \cos \theta } \\
  {{{\sin }^2}\theta }&amp;{{{\cos }^2}\theta }&amp;{ - \sin \theta \cos \theta } \\
  { - 2\sin \theta \cos \theta }&amp;{2\sin \theta \cos \theta }&amp;{{{\cos }^2}\theta  - {{\sin }^2}\theta }
\end{array}} \right]
\tag{14.32}\]</span></span></p>
<p>in which <span class="math inline">\(\theta\)</span> is the angle between the <span class="math inline">\(n\)</span>-axis and <span class="math inline">\(x\)</span>-axis as shown in <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> c.&nbsp;With increasing strain softening, the damaged elastic modulus <span class="math inline">\(E_{n}\)</span> (see <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> d), and therefore the parameters <span class="math inline">\(\eta\)</span> and <span class="math inline">\(\mu\)</span> decrease gradually and may eventually reach zero values after complete fracture (<span class="math inline">\(\varepsilon_{n}&gt;\varepsilon_{cr}\)</span>). The damaged state constitutive matrix given in <a href="#eq-ch7-82" class="quarto-xref">Equation&nbsp;<span>14.30</span></a> is updated as the parameters <span class="math inline">\(\eta\)</span> and <span class="math inline">\(\mu\)</span> change their values, and these changes are also reflected in the global constitutive matrix (see <a href="#eq-ch7-84" class="quarto-xref">Equation&nbsp;<span>14.31</span></a>). In addition, the change in global constitutive matrix <span class="math inline">\(\left[ \mathbf{C}_{global} \right]\)</span> is also caused by a rotation of the local axis system, which is always kept aligned with the directions of principal strains to keep the principal stresses and strains coaxial. The CRCM is very effective in alleviating the stress locking which is usually observed in fixed crack models <span class="citation" data-cites="Rots1991">(<a href="references.html#ref-Rots1991" role="doc-biblioref">Rots 1991</a>)</span>.</p>
</section>
<section id="closing-and-reopening-of-cracks" class="level3" data-number="14.3.5">
<h3 data-number="14.3.5" class="anchored" data-anchor-id="closing-and-reopening-of-cracks"><span class="header-section-number">14.3.5</span> Closing and reopening of cracks</h3>
<p>During the unloading/reloading, when the strain, <span class="math inline">\(\varepsilon_{n}\)</span>, is less than the previously attained maximum value, <span class="math inline">\(\varepsilon_{max}\)</span> (see <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> d), the secant modulus, <span class="math inline">\(E_{n}\)</span> and therefore <span class="math inline">\(\eta\)</span>, do not change; however, the parameter <span class="math inline">\(\mu\)</span> changes during this process. During unloading the shear reduction factor, <span class="math inline">\(\mu\)</span>, gradually increases with the reduction of <span class="math inline">\(\varepsilon_{n}\)</span>. The damaged state elastic modulus in the normal direction, <span class="math inline">\(E_{n}\)</span> (which may have reached a zero value), is replaced by the undamaged initial value, <span class="math inline">\(E_{0}\)</span>, if the parameter <span class="math inline">\(\mu\)</span> is greater than a threshold value <span class="math inline">\(\mu_{c}\)</span>. In this study <span class="math inline">\(\mu_{c}=0.95\)</span> is considered. In subsequent loading steps, when <span class="math inline">\(\varepsilon_{n}&gt;0\)</span>, the value <span class="math inline">\(\mu\)</span> is determined by using the damaged value <span class="math inline">\(\eta\)</span> to determine the reopening of cracks. If <span class="math inline">\(\mu\)</span> becomes less than <span class="math inline">\(\mu_{c}\)</span>, the element behavior is determined by either reloading or the reopening path depending on the final state attained in previous tensile cycles. The appropriate value of the damage modulus, <span class="math inline">\(E_{n}\)</span>, is reused in <a href="#eq-ch7-82" class="quarto-xref">Equation&nbsp;<span>14.30</span></a> at that state.</p>
<p>In what follows an informal explanation regarding the the physical significance of CRCM during the unloading/reloading process is presented. Imagine the smeared band of micro-cracks developed inside the test-specimen subjected to dynamic loading. In addition, assume that the material is partially damaged (this state is described by point-A in <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> d). At this stage, strength of the material has degraded in both normal and tangential directions to the plane. In CRCM this corresponds to the <span class="math inline">\(\eta&lt;1.0\)</span> and <span class="math inline">\(\mu&lt;1.0\)</span>, where the former and later are related to the strength reduction in normal and tangential directions, respectively. At this stage, if loading continues then <span class="math inline">\(\eta\)</span> and <span class="math inline">\(\mu\)</span> will keep decreasing denoting the strength reduction in smeared band due to growth of cracks. In case of unloading, the normal strain <span class="math inline">\(\varepsilon_{n}\)</span> decreases and cracks start closing, accordingly the shear resistance factor, <span class="math inline">\(\mu\)</span>, starts to increase compare to its value at point-A in <a href="#fig-ch7-2" class="quarto-xref">Figure&nbsp;<span>14.2</span></a> d.&nbsp;This signifies the gain of strength in tangential direction to the damaged plane due to the partial closing of cracks. During unloading, as long as the cracks are still opened (i.e.&nbsp;<span class="math inline">\(\mu&lt;\mu_{c}\)</span>), the strength in the normal direction remains same as that of point-A. In CRCM, this behavior is simulated by keeping</p>
<p><span class="math inline">\(E_{n}\)</span> and <span class="math inline">\(\eta\)</span> fixed to their values at point point-A as long as the condition <span class="math inline">\(\mu&lt;\mu_{c}\)</span> is satisfied. The condition <span class="math inline">\(\mu \ge \mu_{c}\)</span> depicts the state of fully closed cracks. In this situation material regains its undamaged initial compressible strength. In addition to <span class="math inline">\(\mu \ge \mu_{c}\)</span>, one should also check the value of <span class="math inline">\(\eta\)</span> since <span class="math inline">\(\eta&lt;1\)</span> and <span class="math inline">\(eta=1\)</span> refer to the damaged and undamaged state, respectively. During reloading, partially or fully closed cracks reopen, and the condition <span class="math inline">\(\mu &lt; \mu_{c}\)</span> is satisfied. The element behavior is determined by either reloading or the reopening path depending on the final state attained in previous tensile cycles. The appropriate values, <span class="math inline">\(\eta\)</span>, <span class="math inline">\(\mu\)</span>, and <span class="math inline">\(E_{n}\)</span> should be used in <a href="#eq-ch7-82" class="quarto-xref">Equation&nbsp;<span>14.30</span></a> to compute the constitutive matrix.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-Bazant1987" class="csl-entry" role="listitem">
Bažant, Zdeněk P. 1987. <span>“Snapback Instability at Crack Ligament Tearing and Its Implication for Fracture Micromechanics.”</span> <em>Cement and Concrete Research</em> 17 (6): 951–67.
</div>
<div id="ref-Bhattacharjee1993" class="csl-entry" role="listitem">
Bhattacharjee, SS, and P Leger. 1993. <span>“Seismic Cracking and Energy Dissipation in Concrete Gravity Dams.”</span> <em>Earthquake Engineering &amp; Structural Dynamics</em> 22 (11): 991–1007.
</div>
<div id="ref-Bruhwiler1990" class="csl-entry" role="listitem">
Brühwiler, E. 1990. <span>“Fracture of Mass Concreete Under Simulated Seismic Action.”</span> <em>Dam Engineering</em> 1 (EPFL-ARTICLE-181083): 153–76.
</div>
<div id="ref-Calayir2005" class="csl-entry" role="listitem">
Calayir, Yusuf, and Muhammet Karaton. 2005. <span>“Seismic Fracture Analysis of Concrete Gravity Dams Including Dam–Reservoir Interaction.”</span> <em>Computers &amp; Structures</em> 83 (19-20): 1595–1606.
</div>
<div id="ref-Cervera1995" class="csl-entry" role="listitem">
Cervera, Miguel, Javier Oliver, and Rui Faria. 1995. <span>“Seismic Evaluation of Concrete Dams via Continuum Damage Models.”</span> <em>Earthquake Engineering &amp; Structural Dynamics</em> 24 (9): 1225–45.
</div>
<div id="ref-Fenves1983" class="csl-entry" role="listitem">
Fenves, G., and A. K. Chopra. 1983. <span>“Effects of Reservoir Bottom Absorption on Earthquake Response of Concrete Gravity Dams.”</span> <em>Earthquake Engineering &amp; Structural Dynamics</em> 11 (6): 809–29.
</div>
<div id="ref-Geers2000" class="csl-entry" role="listitem">
Geers, MGD, R De Borst, and RHJ Peerlings. 2000. <span>“Damage and Crack Modeling in Single-Edge and Double-Edge Notched Concrete Beams.”</span> <em>Engineering Fracture Mechanics</em> 65 (2-3): 247–61.
</div>
<div id="ref-Giry2011" class="csl-entry" role="listitem">
Giry, Cédric, Frédéric Dufour, and Jacky Mazars. 2011. <span>“Stress-Based Nonlocal Damage Model.”</span> <em>International Journal of Solids and Structures</em> 48 (25-26): 3431–43.
</div>
<div id="ref-Hashiguchi2014" class="csl-entry" role="listitem">
Hashiguchi, Koichi. 2014. <em>Elastoplasticity Theory</em>. Springer.
</div>
<div id="ref-Hillerborg1976" class="csl-entry" role="listitem">
Hillerborg, Arne, Mats Modéer, and P-E Petersson. 1976. <span>“Analysis of Crack Formation and Crack Growth in Concrete by Means of Fracture Mechanics and Finite Elements.”</span> <em>Cement and Concrete Research</em> 6 (6): 773–81.
</div>
<div id="ref-Jirasek2008" class="csl-entry" role="listitem">
Jirasek, Milan, and Peter Grassl. 2008. <span>“Evaluation of Directional Mesh Bias in Concrete Fracture Simulations Using Continuum Damage Models.”</span> <em>Engineering Fracture Mechanics</em> 75 (8): 1921–43.
</div>
<div id="ref-Kurumatani2016" class="csl-entry" role="listitem">
Kurumatani, Mao, Kenjiro Terada, Junji Kato, Takashi Kyoya, and Kazuo Kashiyama. 2016. <span>“An Isotropic Damage Model Based on Fracture Mechanics for Concrete.”</span> <em>Engineering Fracture Mechanics</em> 155: 49–66.
</div>
<div id="ref-Lee1998" class="csl-entry" role="listitem">
Lee, Jeeho, and Gregory L Fenves. 1998. <span>“A Plastic-Damage Concrete Model for Earthquake Analysis of Dams.”</span> <em>Earthquake Engineering &amp; Structural Dynamics</em> 27 (9): 937–56.
</div>
<div id="ref-Peerlings1998" class="csl-entry" role="listitem">
Peerlings, RHJ, R De Borst, WAM Brekelmans, and MGD Geers. 1998. <span>“Gradient-Enhanced Damage Modelling of Concrete Fracture.”</span> <em>Mechanics of Cohesive-Frictional Materials: An International Journal on Experiments, Modelling and Computation of Materials and Structures</em> 3 (4): 323–42.
</div>
<div id="ref-Rots1991" class="csl-entry" role="listitem">
Rots, Jan G. 1991. <span>“Smeared and Discrete Representations of Localized Fracture.”</span> In <em>Current Trends in Concrete Fracture Research</em>, 45–59. Springer.
</div>
<div id="ref-Zienkiewicz2005" class="csl-entry" role="listitem">
Zienkiewicz, O. C., and R. L. Taylor. 2005. <em>The Finite Element Method for Solid and Structural Mechanics</em>. Elsevier.
</div>
</div>
</section>
</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>The CRCM model was first proposed by <span class="citation" data-cites="Bhattacharjee1993">(<a href="references.html#ref-Bhattacharjee1993" role="doc-biblioref">Bhattacharjee and Leger 1993</a>)</span> and recently modified by <span class="citation" data-cites="Calayir2005">(<a href="references.html#ref-Calayir2005" role="doc-biblioref">Calayir and Karaton 2005</a>)</span><a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>The fracture energy is defined as the energy per unit area required to form a fracture surface<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/poromechanics\.github\.io\/sdee");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./dynamic-ssi-drs-vstfem.html" class="pagination-link" aria-label="VSTFEM for dynamic SSI in dam-reservoir system">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">VSTFEM for dynamic SSI in dam-reservoir system</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./dynamic-ssi-drs-nonlinear-vstfem.html" class="pagination-link" aria-label="V-STFEM for nonlinear dynamic analysis of concrete gravity dams">
        <span class="nav-page-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">V-STFEM for nonlinear dynamic analysis of concrete gravity dams</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Vikas Sharma</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/poromechanics/sdee/edit/main/dynamic-ssi-drs-nonlinear-problem.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/poromechanics/sdee/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vickysharma0812">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/vickysharma0812">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/vickysharma0812">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>